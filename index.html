
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mint RPG NFT (TON Testnet)</title>
  <script src="https://unpkg.com/tonweb/dist/tonweb.js"></script>
  <script src="https://unpkg.com/@tonconnect/ui@2"></script>
</head>

<body style="background:#111;color:white;font-family:Arial;padding:20px;">
  <h2>Mint RPG NFT (TON Testnet)</h2>

  <!-- TonConnect Wallet Button -->
  <div id="connect"></div>

  <button id="mintBtn" style="margin-top:20px;padding:10px 20px;font-size:18px;display:none;">
    Mint RPG NFT
  </button>

  <p id="status" style="margin-top:20px;"></p>

  <script>
    // Connect TON Wallet
    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
      manifestUrl: "https://raw.githubusercontent.com/ton-connect/demo-dapp-with-react/master/public/tonconnect-manifest.json"
    });

    tonConnectUI.mountWalletButton(document.getElementById("connect"));

    // Toggle mint button only after wallet connection
    tonConnectUI.onStatusChange(wallet => {
      if (wallet) {
        document.getElementById("mintBtn").style.display = "block";
      }
    });

    // Mint Button
    document.getElementById("mintBtn").onclick = async () => {
      document.getElementById("status").innerHTML = "Minting NFT...";

      const TonWeb = window.TonWeb;
      const tonweb = new TonWeb(
        new TonWeb.HttpProvider("https://testnet.toncenter.com/api/v2/jsonRPC")
      );

      // ***** YOUR NFT METADATA *****
      const contentUri = "https://your-json-metadata-url.com/rpg-nft.json";

      // Create NFT contract instance
      const NFT = TonWeb.token.nft;
      const collection = new NFT.NftCollection(tonweb.provider, {
        ownerAddress: tonConnectUI.account.address,
        royalty: 0,
        royaltyAddress: tonConnectUI.account.address,
        collectionContentUri: "https://zaddiii.github.io/RPG-NFT/",
        nftItemContentBaseUri: contentUri,
      });

      const deployAmount = TonWeb.utils.toNano("0.05");

      // Send transaction to deploy + create NFT
      const tx = {
        validUntil: Math.floor(Date.now() / 1000) + 600,
        messages: [
          {
            address: collection.address.toString(true, true, true),
            amount: deployAmount.toString(),
            payload: ""
          }
        ]
      };

      try {
        await tonConnectUI.sendTransaction(tx);
        document.getElementById("status").innerHTML =
          "NFT Minted Successfully! Check TON Testnet Explorer.";
      } catch (e) {
        document.getElementById("status").innerHTML = "Error: " + e;
      }
    };
  </script>
</body>
</html>